# ATLAS v5 vs v6 Statistical Comparison

## Summary

This report compares the legacy (incorrect) and corrected statistical methods.

**Key Differences:**
1. **Bin Integration**: Legacy uses center × width; Correct uses Gauss-Legendre quadrature
2. **Bootstrap**: Legacy samples from observed counts; Correct samples from constrained-null model (μ_H0)

## Fit Quality Comparison

| Metric | Legacy | Correct |
|--------|--------|---------|
| 4μ χ²/dof | 1.393 | 1.383 |
| 4μ D/dof | 1.343 | 1.336 |
| 4μ+2π χ²/dof | 9.742 | 9.559 |
| 4μ+2π D/dof | 8.959 | 8.828 |

## Best-Fit Parameters

| Parameter | Legacy | Correct |
|-----------|--------|---------|
| r_4μ | 0.4010 | 0.3886 |
| φ_4μ (deg) | -82.7 | -82.2 |
| r_4μ+2π | 0.3027 | 0.2956 |
| φ_4μ+2π (deg) | -96.8 | -97.6 |
| r_shared | 0.3261 | 0.3221 |
| φ_shared (deg) | -95.1 | -95.4 |

## Likelihood Ratio Test

| Metric | Legacy | Correct |
|--------|--------|---------|
| NLL_unconstrained | -3986.30 | -3987.32 |
| NLL_constrained | -3985.53 | -3986.53 |
| **Λ_obs** | **1.5370** | **1.5661** |

## Bootstrap p-value Comparison

| Metric | Legacy | Correct |
|--------|--------|---------|
| Bootstrap | NOT COMPUTED | NOT COMPUTED |

## Interpretation

The p-value difference between legacy and correct methods is
N/A (bootstrap not computed - gates failed).

**Why the difference matters:**
- Legacy method samples from observed data, which may not follow H₀
- Correct method samples from the constrained-null model, properly testing H₀
- For a valid LRT, we need P(Λ ≥ Λ_obs | H₀), which requires sampling under H₀

## Gates Status

| Channel | Legacy | Correct |
|---------|--------|---------|
| 4μ | PASS | PASS |
| 4μ+2π | FAIL | FAIL |
| Overall | FAIL | FAIL |

---
*Generated by fit_atlas_v6.py*
